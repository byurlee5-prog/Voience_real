<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Voience Real</title>
</head>
<body>
  <h1>Voience Real 사이트</h1>
  <button id="record">녹음 시작</button>
  <button id="stop">녹음 종료</button>
  <button id="upload">업로드</button>
  <script>
    let mediaRecorder;
    let audioChunks = [];

    document.getElementById("record").onclick = async () => {
      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
      mediaRecorder = new MediaRecorder(stream);
      mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
      mediaRecorder.start();
      alert("녹음 시작!");
    };

    document.getElementById("stop").onclick = () => {
      mediaRecorder.stop();
      alert("녹음 종료!");
    };

    document.getElementById("upload").onclick = async () => {
      const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
      const formData = new FormData();
      formData.append("file", audioBlob, "recording.wav");

      await fetch("/api/upload", { method: "POST", body: formData });
      alert("업로드 완료! 카카오톡으로 전송됩니다.");
    };
  </script>
</body>
</html>
